package com.qasystem.mapper;

import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import com.qasystem.entity.Subject;
import org.apache.ibatis.annotations.Mapper;

import java.util.List;

/**
 * SubjectMapperæ¥å£ - ç§‘ç›®æ•°æ®è®¿é—®å±‚
 * 
 * ğŸ¯ ä½œç”¨è¯´æ˜ï¼š
 * è¿™ä¸ªæ¥å£è´Ÿè´£æ“ä½œæ•°æ®åº“ä¸­çš„subjectè¡¨ï¼Œå°±åƒä¸€ä¸ª"ç§‘ç›®ç›®å½•ç®¡ç†å‘˜"ã€‚
 * ç®¡ç†ç€ç³»ç»Ÿä¸­æ‰€æœ‰å¯ä¾›é€‰æ‹©çš„å­¦ç§‘ç§‘ç›®ï¼Œæ¯”å¦‚ï¼šé«˜ç­‰æ•°å­¦ã€çº¿æ€§ä»£æ•°ã€æ¦‚ç‡è®ºã€è®¡ç®—æœºç½‘ç»œç­‰ã€‚
 * 
 * ğŸ“š ç³»ç»Ÿä¸­çš„ä½œç”¨ï¼š
 * 1. æä¾›ç§‘ç›®åˆ†ç±»ï¼šå­¦ç”Ÿæé—®æ—¶éœ€è¦é€‰æ‹©ç§‘ç›®
 * 2. é—®é¢˜ç­›é€‰ï¼šæ•™å¸ˆæ ¹æ®ç§‘ç›®ç­›é€‰è‡ªå·±æ“…é•¿çš„é—®é¢˜
 * 3. æ•™å¸ˆæ ‡ç­¾ï¼šæ•™å¸ˆæ³¨å†Œæ—¶é€‰æ‹©æ“…é•¿çš„ç§‘ç›®
 * 4. ç»Ÿè®¡åˆ†æï¼šæŸ¥çœ‹æ¯ä¸ªç§‘ç›®çš„é—®é¢˜æ•°é‡ã€çƒ­åº¦ç­‰
 * 
 * ğŸ—ï¸ æŠ€æœ¯æ¶æ„ï¼š
 * - ç»§æ‰¿è‡ªMyBatis-Plusçš„BaseMapper<Subject>
 * - BaseMapperè‡ªåŠ¨æä¾›17ä¸ªåŸºç¡€æ–¹æ³•
 * - æˆ‘ä»¬æ·»åŠ äº†findAllActive()æ–¹æ³•ï¼Œç”¨äºæŸ¥è¯¢æ‰€æœ‰å¯ç”¨çš„ç§‘ç›®
 * - ç§‘ç›®æœ‰å¯ç”¨/ç¦ç”¨çŠ¶æ€ï¼Œåªæ˜¾ç¤ºå¯ç”¨çš„ç§‘ç›®ç»™ç”¨æˆ·
 * 
 * ğŸ“Š å¯¹åº”æ•°æ®åº“è¡¨: subject
 * 
 * ğŸ”— å…³è”å…³ç³»ï¼š
 * - è¢«questionè¡¨å…³è”ï¼šquestion.subject_id = subject.id ï¼ˆé—®é¢˜å±äºæŸä¸ªç§‘ç›®ï¼‰
 * - ä¸teacherè¡¨å¤šå¯¹å¤šå…³è”ï¼šé€šè¿‡teacher_subjectä¸­é—´è¡¨ ï¼ˆæ•™å¸ˆæ“…é•¿å¤šä¸ªç§‘ç›®ï¼‰
 * 
 * ğŸ”§ MyBatis-Plusæä¾›çš„å…è´¹æ–¹æ³•ï¼š
 * - insert(Subject s)ï¼šæ’å…¥æ–°ç§‘ç›®
 * - deleteById(Long id)ï¼šåˆ é™¤ç§‘ç›®
 * - updateById(Subject s)ï¼šæ›´æ–°ç§‘ç›®ä¿¡æ¯
 * - selectById(Long id)ï¼šæ ¹æ®IDæŸ¥è¯¢ç§‘ç›®
 * - selectList(Wrapper)ï¼šæŸ¥è¯¢ç§‘ç›®åˆ—è¡¨
 * 
 * ğŸ’¡ ä½¿ç”¨åœºæ™¯ï¼š
 * 1. å­¦ç”Ÿæé—®ï¼šæ˜¾ç¤ºç§‘ç›®ä¸‹æ‹‰æ¡†ä¾›å­¦ç”Ÿé€‰æ‹©
 * 2. é—®é¢˜åˆ—è¡¨ç­›é€‰ï¼šæ ¹æ®ç§‘ç›®æŸ¥è¯¢é—®é¢˜
 * 3. æ•™å¸ˆæ³¨å†Œï¼šé€‰æ‹©æ“…é•¿çš„ç§‘ç›®
 * 4. ç®¡ç†å‘˜ç®¡ç†ï¼šå¢åŠ /ä¿®æ”¹/ç¦ç”¨ç§‘ç›®
 * 5. é¦–é¡µæ˜¾ç¤ºï¼šæ˜¾ç¤ºçƒ­é—¨ç§‘ç›®
 * 
 * âš ï¸ é‡è¦æç¤ºï¼š
 * 1. è¿™æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸éœ€è¦ç¼–å†™å®ç°ç±»
 * 2. @Mapperæ³¨è§£è®©MyBatisè‡ªåŠ¨ç”Ÿæˆå®ç°ä»£ç 
 * 3. ç§‘ç›®æ•°æ®ä¸€èˆ¬æ¯”è¾ƒç¨³å®šï¼Œå»ºè®®åŠ å…¥ç¼“å­˜ï¼ˆå¦‚Redisï¼‰
 * 4. ç§‘ç›®çš„æ’åºé¡ºåºå¾ˆé‡è¦ï¼Œå½±å“é¡µé¢æ˜¾ç¤ºé¡ºåº
 * 
 * @author QA System Team
 * @version 1.0
 */
@Mapper
public interface SubjectMapper extends BaseMapper<Subject> {

    /**
     * æŸ¥è¯¢æ‰€æœ‰å¯ç”¨çš„ç§‘ç›®ï¼ˆæŒ‰æ’åºï¼‰
     * 
     * ğŸ¯ æ–¹æ³•ä½œç”¨ï¼š
     * æŸ¥è¯¢æ‰€æœ‰çŠ¶æ€ä¸ºâ€œå¯ç”¨â€çš„ç§‘ç›®ï¼Œå¹¶æŒ‰ç…§æŒ‡å®šçš„æ’åºé¡ºåºè¿”å›ã€‚
     * å°±åƒåœ¨é€‰è¯¾ç³»ç»Ÿä¸­æ˜¾ç¤ºæ‰€æœ‰å¯é€‰çš„è¯¾ç¨‹ï¼Œä¸æ˜¾ç¤ºå·²åœå¼€çš„è¯¾ç¨‹ã€‚
     * è¿™æ˜¯ç³»ç»Ÿä¸­éå¸¸å¸¸ç”¨çš„æ–¹æ³•ï¼Œå»ºè®®å°†ç»“æœç¼“å­˜èµ·æ¥ã€‚
     * 
     * ğŸ”— ä½¿ç”¨åœºæ™¯ï¼š
     * 
     * 1. å­¦ç”Ÿæé—®é¡µé¢ï¼š
     *    - æ˜¾ç¤ºç§‘ç›®ä¸‹æ‹‰æ¡†ï¼Œä¾›å­¦ç”Ÿé€‰æ‹©é—®é¢˜æ‰€å±ç§‘ç›®
     *    - åªæ˜¾ç¤ºå¯ç”¨çš„ç§‘ç›®ï¼Œä¸æ˜¾ç¤ºå·²ç¦ç”¨çš„ç§‘ç›®
     * 
     * 2. é—®é¢˜åˆ—è¡¨ç­›é€‰ï¼š
     *    - åœ¨é—®é¢˜åˆ—è¡¨é¡µé¢æ˜¾ç¤ºç§‘ç›®ç­›é€‰å™¨
     *    - ç”¨æˆ·å¯ä»¥é€‰æ‹©æŸä¸ªç§‘ç›®æ¥ç­›é€‰é—®é¢˜
     * 
     * 3. æ•™å¸ˆæ³¨å†Œ/ä¿®æ”¹èµ„æ–™ï¼š
     *    - æ˜¾ç¤ºç§‘ç›®å¤šé€‰æ¡†ï¼Œæ•™å¸ˆé€‰æ‹©æ“…é•¿çš„ç§‘ç›®
     *    - åªæ˜¾ç¤ºå¯ç”¨çš„ç§‘ç›®
     * 
     * 4. é¦–é¡µç§‘ç›®å¯¼èˆªï¼š
     *    - æ˜¾ç¤ºç§‘ç›®åˆ†ç±»å¯¼èˆªæ 
     *    - ç”¨æˆ·ç‚¹å‡»ç§‘ç›®å¯ä»¥çœ‹åˆ°è¯¥ç§‘ç›®ä¸‹çš„æ‰€æœ‰é—®é¢˜
     * 
     * 5. ç®¡ç†å‘˜ç»Ÿè®¡ï¼š
     *    - ç»Ÿè®¡æ¯ä¸ªç§‘ç›®çš„é—®é¢˜æ•°é‡ã€å›ç­”ç‡ç­‰
     *    - åªç»Ÿè®¡å¯ç”¨çš„ç§‘ç›®
     * 
     * ğŸ” æŸ¥è¯¢é€»è¾‘è¯¦è§£ï¼š
     * 
     * 1. åˆ›å»ºLambdaQueryWrapperæŸ¥è¯¢æ¡ä»¶æ„é€ å™¨
     * 
     * 2. .eq(Subject::getStatus, "ACTIVE")
     *    - è®¾ç½®æŸ¥è¯¢æ¡ä»¶ï¼šstatus = 'ACTIVE'
     *    - åªæŸ¥è¯¢å¯ç”¨çš„ç§‘ç›®
     *    - ACTIVEè¡¨ç¤ºå¯ç”¨ï¼ŒINACTIVEè¡¨ç¤ºç¦ç”¨
     * 
     * 3. .orderByAsc(Subject::getSortOrder, Subject::getId)
     *    - æŒ‰ç…§æ’åºå­—æ®µï¼ˆsort_orderï¼‰å‡åº
     *    - å¦‚æœsort_orderç›¸åŒï¼Œå†æŒ‰IDå‡åº
     *    - sort_orderæ˜¯ç®¡ç†å‘˜æ‰‹åŠ¨è®¾ç½®çš„ï¼Œç”¨äºæ§åˆ¶ç§‘ç›®æ˜¾ç¤ºé¡ºåº
     *    - æ¯”å¦‚ï¼šé«˜ç­‰æ•°å­¦ï¼ˆsort_order=1ï¼‰ > çº¿æ€§ä»£æ•°ï¼ˆsort_order=2ï¼‰
     * 
     * 4. selectList()æ‰§è¡ŒæŸ¥è¯¢ï¼Œè¿”å›ç§‘ç›®åˆ—è¡¨
     * 
     * ğŸ“ ä½¿ç”¨ç¤ºä¾‹1 - å­¦ç”Ÿæé—®æ—¶é€‰æ‹©ç§‘ç›®ï¼š
     * <pre>
     * // è·å–æ‰€æœ‰å¯ç”¨çš„ç§‘ç›®
     * List<Subject> subjects = subjectMapper.findAllActive();
     * 
     * // åœ¨å‰ç«¯æ˜¾ç¤ºä¸ºä¸‹æ‹‰é€‰æ‹©æ¡†
     * // <select name="subjectId">
     * for (Subject subject : subjects) {
     *     System.out.println("<option value=\"" + subject.getId() + "\">" 
     *         + subject.getName() + "</option>");
     *     // <option value="1">é«˜ç­‰æ•°å­¦</option>
     *     // <option value="2">çº¿æ€§ä»£æ•°</option>
     * }
     * // </select>
     * </pre>
     * 
     * ğŸ“ ä½¿ç”¨ç¤ºä¾‹2 - é—®é¢˜åˆ—è¡¨ç­›é€‰å™¨ï¼š
     * <pre>
     * // è·å–æ‰€æœ‰å¯ç”¨çš„ç§‘ç›®
     * List<Subject> subjects = subjectMapper.findAllActive();
     * 
     * // è¿”å›ç»™å‰ç«¯æ˜¾ç¤ºç­›é€‰æŒ‰é’®
     * return Result.success(subjects);
     * 
     * // å‰ç«¯æ˜¾ç¤ºï¼š[å…¨éƒ¨] [é«˜ç­‰æ•°å­¦] [çº¿æ€§ä»£æ•°] [æ¦‚ç‡è®º]...
     * // ç‚¹å‡»æŸä¸ªç§‘ç›®åï¼Œè°ƒç”¨é—®é¢˜åˆ—è¡¨æ¥å£æ—¶ä¼ å…¥subjectId
     * </pre>
     * 
     * ğŸ“ ä½¿ç”¨ç¤ºä¾‹3 - æ•™å¸ˆé€‰æ‹©æ“…é•¿ç§‘ç›®ï¼š
     * <pre>
     * // æ•™å¸ˆä¿®æ”¹èµ„æ–™ï¼Œé€‰æ‹©æ“…é•¿ç§‘ç›®
     * List<Subject> subjects = subjectMapper.findAllActive();
     * 
     * // æ˜¾ç¤ºä¸ºå¤šé€‰æ¡†
     * // æ•™å¸ˆå¯ä»¥é€‰æ‹©å¤šä¸ªç§‘ç›®ï¼Œä¾‹å¦‚ï¼š[é«˜ç­‰æ•°å­¦] å’Œ [çº¿æ€§ä»£æ•°]
     * // é€‰æ‹©åï¼Œä¿å­˜åˆ°teacher_subjectä¸­é—´è¡¨
     * for (Long subjectId : selectedSubjectIds) {
     *     // INSERT INTO teacher_subject (teacher_id, subject_id) VALUES (?, ?)
     * }
     * </pre>
     * 
     * ğŸ“ ä½¿ç”¨ç¤ºä¾‹4 - ç¼“å­˜ä¼˜åŒ–ï¼š
     * <pre>
     * // å› ä¸ºç§‘ç›®æ•°æ®å¾ˆå°‘å˜åŒ–ï¼Œå»ºè®®ä½¿ç”¨ç¼“å­˜
     * List<Subject> subjects = redisTemplate.opsForValue().get("subjects:active");
     * 
     * if (subjects == null) {
     *     // ç¼“å­˜ä¸å­˜åœ¨ï¼Œä»æ•°æ®åº“æŸ¥è¯¢
     *     subjects = subjectMapper.findAllActive();
     *     
     *     // å­˜å…¥ç¼“å­˜ï¼Œæœ‰æ•ˆæœŸ1å°æ—¶
     *     redisTemplate.opsForValue().set("subjects:active", subjects, 1, TimeUnit.HOURS);
     * }
     * 
     * return subjects;
     * </pre>
     * 
     * ğŸ¯ å®é™…æ‰§è¡Œçš„SQLï¼š
     * SELECT id, name, description, status, sort_order, create_time, update_time
     * FROM subject
     * WHERE status = 'ACTIVE'
     * ORDER BY sort_order ASC, id ASC
     * 
     * ğŸ“Š è¿”å›ç¤ºä¾‹æ•°æ®ï¼š
     * [
     *   {id: 1, name: "é«˜ç­‰æ•°å­¦", status: "ACTIVE", sortOrder: 1},
     *   {id: 2, name: "çº¿æ€§ä»£æ•°", status: "ACTIVE", sortOrder: 2},
     *   {id: 3, name: "æ¦‚ç‡è®º", status: "ACTIVE", sortOrder: 3},
     *   {id: 4, name: "è®¡ç®—æœºç½‘ç»œ", status: "ACTIVE", sortOrder: 4}
     * ]
     * 
     * @return List<Subject> å¯ç”¨çš„ç§‘ç›®åˆ—è¡¨ï¼ˆæŒ‰sort_orderå’Œidå‡åºï¼‰
     *         - å¦‚æœæ²¡æœ‰å¯ç”¨çš„ç§‘ç›®ï¼Œè¿”å›ç©ºåˆ—è¡¨ï¼ˆä¸æ˜¯nullï¼‰
     *         - ç§‘ç›®æŒ‰ç…§sort_orderæ’åˆ—ï¼Œæ–¹ä¾¿å‰ç«¯ç›´æ¥æ˜¾ç¤º
     *         - æ¯ä¸ªSubjectå¯¹è±¡åŒ…å«idã€nameã€descriptionç­‰å­—æ®µ
     * 
     * âš ï¸ æ³¨æ„äº‹é¡¹ï¼š
     * 1. è¿™ä¸ªæ–¹æ³•æ˜¯é«˜é¢‘è°ƒç”¨çš„ï¼Œå¼ºçƒˆå»ºè®®åŠ å…¥ç¼“å­˜ï¼ˆRedisæˆ–åº”ç”¨ç¼“å­˜ï¼‰
     * 2. åªè¿”å›status='ACTIVE'çš„ç§‘ç›®ï¼Œç¦ç”¨çš„ç§‘ç›®ä¸ä¼šæ˜¾ç¤º
     * 3. æ’åºé¡ºåºä¸ºï¼šsort_orderå‡åº > idå‡åº
     * 4. å¦‚æœç§‘ç›®è¡¨ä¸ºç©ºï¼Œè¿”å›ç©ºåˆ—è¡¨ï¼Œä¸ä¼šè¿”å›null
     * 5. ç®¡ç†å‘˜ä¿®æ”¹ç§‘ç›®ï¼ˆå¯ç”¨/ç¦ç”¨/æ›´æ”¹æ’åºï¼‰æ—¶ï¼Œéœ€è¦æ¸…é™¤ç¼“å­˜
     * 6. sort_orderå­—æ®µå¾ˆé‡è¦ï¼Œå»ºè®®è®¾ç½®ä¸º10ã€20ã€30...ï¼Œä»¥ä¾¿æœªæ¥æ’å…¥æ–°ç§‘ç›®
     * 7. è¿”å›çš„ç§‘ç›®åˆ—è¡¨é€šå¸¸ç”¨äºå‰ç«¯ä¸‹æ‹‰æ¡†ã€ç­›é€‰å™¨ã€å¯¼èˆªæ ç­‰ç»„ä»¶
     */
    default List<Subject> findAllActive() {
        return selectList(new com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper<Subject>()
                .eq(Subject::getStatus, "ACTIVE")
                .orderByAsc(Subject::getSortOrder, Subject::getId));
    }
}

