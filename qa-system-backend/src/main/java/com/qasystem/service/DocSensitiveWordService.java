package com.qasystem.service;

import com.baomidou.mybatisplus.core.metadata.IPage;
import com.qasystem.entity.DocSensitiveWord;

import java.util.List;

/**
 * 🚫 文档敏感词管理服务
 * 
 * 📖 这是什么？
 * 这个服务就像一个"敏感词典管理系统"，用来维护系统中的敏感词库。
 * 就像学校的"违禁物品清单"，管理员可以添加、修改、删除清单中的物品。
 * 
 * 🎯 核心功能：
 * 1. 查询敏感词：分页查询所有敏感词，支持筛选和搜索
 * 2. 添加敏感词：当发现新的敏感词汇时，添加到词库
 * 3. 修改敏感词：修改词汇内容、类别或启用状态
 * 4. 删除敏感词：删除过时或错误的敏感词
 * 5. 获取启用词库：为扫描服务提供启用的敏感词列表
 * 
 * 💡 敏感词分类：
 * - 政治敏感：政治相关的敏感词汇
 * - 暴力血腥：涉及暴力的词汇
 * - 色情低俗：不良内容相关的词汇
 * - 危险行为：引导危险行为的词汇
 * - 其他：其他需要过滤的词汇
 * 
 * 💬 使用场景：
 * - 管理员发现新的敏感词，添加到词库
 * - 某个词汇不再敏感，禁用或删除
 * - 批量导入敏感词列表
 * - 查看系统中有多少敏感词，分别属于哪个类别
 * 
 * @author 师生答疑系统开发团队
 */
public interface DocSensitiveWordService {

    /**
     * 📑 分页查询敏感词列表
     * 
     * 🎯 功能说明：
     * 查询系统中的所有敏感词，支持分页、搜索和筛选。
     * 就像查看“违禁物品清单”，可以搜索某个物品是否在清单中。
     * 
     * 💡 支持的筛选条件：
     * - 按关键词搜索：模糊搜索敏感词内容
     * - 按类别筛选：只查看某一类（如政治敏感、色情低俗）
     * - 按启用状态：只查看启用或禁用的敏感词
     * 
     * 💬 使用场景：
     * - 管理员进入敏感词管理页面，查看所有敏感词
     * - 搜索某个词汇是否已经在词库中
     * - 查看“政治敏感”类别下有多少词汇
     * - 查看哪些敏感词被禁用了
     * 
     * 📥 参数说明：
     * @param page 页码，从1开始
     * @param size 每页条数
     * @param keyword 搜索关键词，可为null（模糊匹配敏感词内容）
     * @param category 类别，可为null（如："政治敏感"、"色情低俗"）
     * @param enabled 启用状态，可为null（true=启用，false=禁用）
     * 
     * 📤 返回内容示例：
     * {
     *   "total": 2580,                           // 总记录数
     *   "pages": 258,                            // 总页数
     *   "current": 1,                            // 当前页
     *   "size": 10,                              // 每页条数
     *   "records": [
     *     {
     *       "id": 1,
     *       "word": "敏感词1",                 // 敏感词内容
     *       "category": "政治敏感",           // 所属类别
     *       "enabled": true,                     // 是否启用
     *       "level": "high",                     // 敏感等级（high/medium/low）
     *       "createTime": "2024-01-15 10:00:00",
     *       "updateTime": "2024-01-15 10:00:00"
     *     },
     *     {
     *       "id": 2,
     *       "word": "敏感词2",
     *       "category": "色情低俗",
     *       "enabled": false,                    // 已禁用
     *       "level": "medium",
     *       "createTime": "2024-01-10 15:30:00",
     *       "updateTime": "2024-01-15 09:20:00"
     *     }
     *   ]
     * }
     * 
     * @return 分页后的敏感词列表
     */
    IPage<DocSensitiveWord> page(Integer page, Integer size, String keyword, String category, Boolean enabled);

    /**
     * ➕ 添加新的敏感词
     * 
     * 🎯 功能说明：
     * 向敏感词库中添加一个新的敏感词。
     * 就像在“违禁物品清单”中加入一个新的物品。
     * 
     * 💡 添加后的效果：
     * - 如果word.enabled=true，新词立即生效，系统会在扫描时检测这个词
     * - 如果word.enabled=false，词汇被添加但不会被扫描（备用状态）
     * - 系统会自动清除敏感词扫描服务的缓存，让新词立即生效
     * 
     * 💬 使用场景：
     * - 管理员发现一个新的敏感词汇，添加到词库
     * - 从外部数据源批量导入敏感词
     * - 根据最新的政策要求，新增敏感词汇
     * 
     * 📥 参数示例：
     * {
     *   "word": "新敏感词",                   // 要添加的词汇
     *   "category": "政治敏感",             // 所属类别
     *   "enabled": true,                       // 立即启用
     *   "level": "high",                       // 敏感等级
     *   "description": "根据最新政策添加"  // 备注说明
     * }
     * 
     * ⚠️ 注意事项：
     * - 添加前会检查词汇是否已存在，避免重复
     * - 敏感词添加后立即生效，谨慎操作
     * - 建议先设置enabled=false测试，确认无误后再启用
     * 
     * @param word 要添加的敏感词对象
     * @return 添加后的敏感词对象（包含生成的id和创建时间）
     */
    DocSensitiveWord create(DocSensitiveWord word);

    /**
     * ✏️ 修改敏感词
     * 
     * 🎯 功能说明：
     * 修改已存在的敏感词的内容、类别或启用状态。
     * 就像更新“违禁物品清单”中的某个物品信息。
     * 
     * 💡 常见修改场景：
     * - 修改词汇内容：发现输入错误，纠正词汇
     * - 调整类别：把词汇从“政治敏感”改为“其他”
     * - 启用/禁用：临时禁用某个敏感词，或重新启用
     * - 调整等级：改变敏感等级（high/medium/low）
     * 
     * 💬 使用场景：
     * - 某个词汇不再敏感，设置enabled=false禁用
     * - 政策变化，某个词汇重新变得敏感，设置enabled=true
     * - 发现词汇类别划分错误，重新分类
     * - 修改备注说明，添加更详细的描述
     * 
     * 📥 参数说明：
     * @param id 要修改的敏感词ID
     * @param word 新的敏感词信息
     * 
     * 📥 修改示例：
     * // 禁用某个敏感词
     * update(1L, {
     *   "enabled": false                       // 设为禁用
     * });
     * 
     * // 修改类别和等级
     * update(2L, {
     *   "category": "其他",                 // 改变类别
     *   "level": "low"                         // 降低敏感等级
     * });
     * 
     * ⚠️ 注意事项：
     * - 修改后立即生效，影响所有扫描功能
     * - 禁用敏感词后，系统不会再扫描该词
     * - 修改词汇内容时要确认新内容正确
     * 
     * @return 修改后的敏感词对象
     */
    DocSensitiveWord update(Long id, DocSensitiveWord word);

    /**
     * 🗑️ 删除敏感词
     * 
     * 🎯 功能说明：
     * 从敏感词库中删除指定的敏感词。
     * 就像从“违禁物品清单”中移除某个物品。
     * 
     * 💡 与禁用的区别：
     * - 禁用（enabled=false）：词汇还在数据库中，只是不扫描，可以随时重新启用
     * - 删除：词汇完全从数据库中移除，无法恢复
     * 
     * 💬 使用场景：
     * - 误添加了错误的敏感词
     * - 某个词汇完全不再需要过滤
     * - 清理过时的敏感词数据
     * 
     * 📥 参数说明：
     * @param id 要删除的敏感词ID
     * 
     * ⚠️ 重要警告：
     * - 删除操作不可恢复！
     * - 如果只是临时不需要，建议使用update()设置enabled=false
     * - 删除后，该词汇不会再被扫描检测
     * - 删除前确认该词汇确实不再需要
     */
    void delete(Long id);

    /**
     * 📋 获取所有启用的敏感词
     * 
     * 🎯 功能说明：
     * 获取所有enabled=true的敏感词，供内容扫描服务使用。
     * 就像获取当前有效的“违禁物品清单”，供安检人员检查使用。
     * 
     * 💡 谁会调用这个方法？
     * 这个方法主要由DocContentFilterService调用：
     * 1. 扫描服务启动时加载所有敏感词到内存
     * 2. 将敏感词构建为DFA树（确定有限自动机）
     * 3. 存储到缓存中，提高扫描性能
     * 4. 当敏感词更新时，重新加载
     * 
     * 💬 使用场景：
     * - 系统启动时，扫描服务加载敏感词库
     * - 管理员修改敏感词后，重新加载词库
     * - 定时任务刷新敏感词缓存
     * 
     * 📤 返回内容示例：
     * [
     *   {
     *     "id": 1,
     *     "word": "敏感词1",
     *     "category": "政治敏感",
     *     "enabled": true,                     // 只返回启用的
     *     "level": "high"
     *   },
     *   {
     *     "id": 3,
     *     "word": "敏感词3",
     *     "category": "色情低俗",
     *     "enabled": true,
     *     "level": "medium"
     *   }
     *   // 注意：enabled=false的词汇不会返回
     * ]
     * 
     * ⚠️ 性能考虑：
     * - 这个方法会返回所有启用的敏感词，数据量可能很大
     * - 建议加载后缓存到内存或Redis，不要每次扫描都查数据库
     * - 可以设置缓存过期时间，定时自动刷新
     * 
     * @return 所有启用的敏感词列表
     */
    List<DocSensitiveWord> listEnabled();
}
