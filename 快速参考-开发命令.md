# 快速参考 - 开发命令速查表

## 📦 项目初始化

### 后端项目创建

```bash
# 使用Spring Initializr创建项目
curl https://start.spring.io/starter.zip \
  -d type=maven-project \
  -d language=java \
  -d bootVersion=3.2.1 \
  -d baseDir=qa-system-backend \
  -d groupId=com.qasystem \
  -d artifactId=qa-system-backend \
  -d name=qa-system-backend \
  -d packageName=com.qasystem \
  -d packaging=jar \
  -d javaVersion=17 \
  -d dependencies=web,security,data-redis,mysql,lombok,validation,actuator \
  -o qa-system-backend.zip

unzip qa-system-backend.zip
cd qa-system-backend
```

### 前端项目创建

```bash
# 使用Vite创建Vue 3 + TypeScript项目
npm create vite@latest qa-system-frontend -- --template vue-ts
cd qa-system-frontend

# 安装核心依赖（一键安装）
npm install vue-router@4 pinia axios element-plus @element-plus/icons-vue @vueuse/core dayjs lodash-es

# 安装开发依赖
npm install -D @types/lodash-es @types/node sass unplugin-vue-components unplugin-auto-import
```

---

## 🗄️ 数据库操作

### 创建数据库

```bash
# 连接MySQL
mysql -u root -p

# 创建数据库
CREATE DATABASE qa_system_v2 CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# 使用数据库
USE qa_system_v2;

# 执行迁移脚本
source /path/to/migration.sql;

# 验证表结构
SHOW TABLES;
DESC sys_student;
```

### 数据迁移

```bash
# 从旧库迁移数据
mysql -u root -p qa_system_v2 < database/migration-data.sql

# 查看迁移结果
mysql -u root -p -e "USE qa_system_v2; SELECT COUNT(*) FROM sys_student;"
```

---

## 🚀 后端开发命令

### Maven命令

```bash
# 清理编译
mvn clean

# 编译项目
mvn compile

# 运行测试
mvn test

# 打包（跳过测试）
mvn package -DskipTests

# 安装到本地仓库
mvn install

# 启动Spring Boot应用
mvn spring-boot:run

# 指定配置文件启动
mvn spring-boot:run -Dspring-boot.run.profiles=dev

# 查看依赖树
mvn dependency:tree

# 更新依赖
mvn versions:use-latest-releases
```

### 常用开发命令

```bash
# 启动应用（开发环境）
mvn spring-boot:run -Dspring-boot.run.profiles=dev

# 启动应用（生产环境）
java -jar -Dspring.profiles.active=prod target/qa-system-backend-2.0.0.jar

# 后台启动
nohup java -jar -Dspring.profiles.active=prod target/qa-system-backend-2.0.0.jar > app.log 2>&1 &

# 查看日志
tail -f logs/qa-system.log

# 查看端口占用
netstat -ano | findstr :8080    # Windows
lsof -i :8080                   # Linux/Mac

# 杀掉进程
taskkill /PID <pid> /F          # Windows
kill -9 <pid>                   # Linux/Mac
```

### MyBatis-Plus代码生成

```bash
# 使用MyBatis-Plus Generator生成代码
mvn mybatis-plus:generator

# 或使用Java代码生成
java -jar mybatis-plus-generator.jar
```

---

## 🎨 前端开发命令

### npm命令

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产构建
npm run preview

# 类型检查
npm run type-check

# 代码格式化
npm run format

# Lint检查
npm run lint

# Lint修复
npm run lint:fix
```

### 开发服务器

```bash
# 启动并自动打开浏览器
npm run dev -- --open

# 指定端口启动
npm run dev -- --port 3001

# 允许外部访问
npm run dev -- --host

# 查看构建分析
npm run build -- --report
```

### 依赖管理

```bash
# 检查过时的依赖
npm outdated

# 更新依赖
npm update

# 更新特定包
npm update element-plus

# 查看包信息
npm info element-plus

# 清除缓存
npm cache clean --force
```

---

## 🐳 Docker命令

### Docker基础命令

```bash
# 构建镜像
docker build -t qa-backend:latest .

# 运行容器
docker run -d -p 8080:8080 --name qa-backend qa-backend:latest

# 查看运行中的容器
docker ps

# 查看所有容器
docker ps -a

# 查看容器日志
docker logs qa-backend
docker logs -f qa-backend  # 持续输出

# 进入容器
docker exec -it qa-backend bash

# 停止容器
docker stop qa-backend

# 删除容器
docker rm qa-backend

# 删除镜像
docker rmi qa-backend:latest

# 清理无用镜像
docker image prune -a
```

### Docker Compose命令

```bash
# 启动所有服务
docker-compose up

# 后台启动
docker-compose up -d

# 查看服务状态
docker-compose ps

# 查看日志
docker-compose logs
docker-compose logs -f backend  # 查看特定服务

# 重启服务
docker-compose restart

# 停止服务
docker-compose stop

# 停止并删除容器
docker-compose down

# 停止并删除容器、网络、卷
docker-compose down -v

# 重新构建并启动
docker-compose up --build

# 扩展服务实例
docker-compose up --scale backend=3
```

### 常用Docker操作

```bash
# 构建并启动
docker-compose up --build -d

# 查看资源使用
docker stats

# 清理所有停止的容器
docker container prune

# 清理所有未使用的镜像
docker image prune -a

# 清理所有未使用的卷
docker volume prune

# 完全清理
docker system prune -a --volumes
```

---

## 🔧 Redis命令

### Redis基础操作

```bash
# 连接Redis
redis-cli

# 连接远程Redis
redis-cli -h 127.0.0.1 -p 6379 -a password

# 查看所有Key
KEYS *

# 查看特定模式的Key
KEYS user:*

# 获取Key的值
GET user:info:123

# 设置Key的值
SET user:info:123 "value"

# 设置带过期时间的Key
SETEX user:info:123 3600 "value"

# 删除Key
DEL user:info:123

# 查看Key的过期时间
TTL user:info:123

# 清空当前数据库
FLUSHDB

# 清空所有数据库
FLUSHALL
```

### Redis监控

```bash
# 查看Redis信息
INFO

# 查看内存使用
INFO memory

# 实时监控命令
MONITOR

# 查看慢日志
SLOWLOG GET 10
```

---

## 🗃️ MySQL命令

### MySQL基础操作

```bash
# 连接MySQL
mysql -u root -p

# 连接远程MySQL
mysql -h 182.92.211.184 -P 3306 -u springboot7vkr2 -p

# 查看数据库
SHOW DATABASES;

# 使用数据库
USE qa_system_v2;

# 查看表
SHOW TABLES;

# 查看表结构
DESC sys_student;
SHOW CREATE TABLE sys_student;

# 查看索引
SHOW INDEX FROM sys_student;

# 导出数据库
mysqldump -u root -p qa_system_v2 > backup.sql

# 导入数据库
mysql -u root -p qa_system_v2 < backup.sql

# 执行SQL文件
mysql -u root -p qa_system_v2 < migration.sql
```

### 性能分析

```bash
# 查看正在执行的查询
SHOW PROCESSLIST;

# 分析查询性能
EXPLAIN SELECT * FROM sys_student WHERE username = 'test';

# 查看慢查询日志
SHOW VARIABLES LIKE 'slow_query%';

# 查看表大小
SELECT 
    table_name, 
    ROUND(((data_length + index_length) / 1024 / 1024), 2) AS size_mb
FROM information_schema.TABLES 
WHERE table_schema = 'qa_system_v2'
ORDER BY size_mb DESC;
```

---

## 🧪 测试命令

### 后端测试

```bash
# 运行所有测试
mvn test

# 运行指定测试类
mvn test -Dtest=UserServiceTest

# 运行指定测试方法
mvn test -Dtest=UserServiceTest#testLogin

# 跳过测试
mvn package -DskipTests

# 生成测试报告
mvn surefire-report:report
```

### API测试（使用curl）

```bash
# 登录接口
curl -X POST http://localhost:8080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123","role":"ADMIN"}'

# 获取用户信息（需要Token）
curl -X GET http://localhost:8080/api/v1/profile/me \
  -H "Authorization: Bearer <token>"

# 发布问题
curl -X POST http://localhost:8080/api/v1/questions \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"title":"测试问题","content":"这是内容","subjectId":1}'

# 上传文件
curl -X POST http://localhost:8080/api/v1/file/avatar \
  -H "Authorization: Bearer <token>" \
  -F "file=@avatar.jpg"
```

---

## 📊 监控命令

### Actuator端点

```bash
# 健康检查
curl http://localhost:8080/actuator/health

# 查看信息
curl http://localhost:8080/actuator/info

# 查看指标
curl http://localhost:8080/actuator/metrics

# 查看Prometheus指标
curl http://localhost:8080/actuator/prometheus

# 查看环境变量
curl http://localhost:8080/actuator/env

# 查看日志级别
curl http://localhost:8080/actuator/loggers
```

### 系统监控

```bash
# 查看Java进程
jps -l

# 查看JVM内存使用
jstat -gc <pid>

# 生成堆转储
jmap -dump:format=b,file=heap.bin <pid>

# 查看线程栈
jstack <pid> > thread.txt

# 实时监控
htop                    # Linux
top                     # Linux/Mac
任务管理器               # Windows
```

---

## 🔍 日志查看

### 后端日志

```bash
# 查看实时日志
tail -f logs/qa-system.log

# 查看最后100行
tail -100 logs/qa-system.log

# 搜索关键词
grep "ERROR" logs/qa-system.log

# 搜索并显示前后10行
grep -C 10 "ERROR" logs/qa-system.log

# 统计错误数量
grep -c "ERROR" logs/qa-system.log

# 查看特定日期的日志
grep "2025-01-27" logs/qa-system.log
```

### Docker日志

```bash
# 查看容器日志
docker logs qa-backend

# 实时查看日志
docker logs -f qa-backend

# 查看最后100行
docker logs --tail 100 qa-backend

# 查看带时间戳的日志
docker logs -t qa-backend
```

---

## 🛠️ 故障排查

### 端口被占用

```bash
# Windows
netstat -ano | findstr :8080
taskkill /PID <pid> /F

# Linux/Mac
lsof -i :8080
kill -9 <pid>
```

### 清理缓存

```bash
# Maven清理
mvn clean
rm -rf target/

# npm清理
rm -rf node_modules/
rm package-lock.json
npm cache clean --force
npm install

# Docker清理
docker system prune -a --volumes
```

### 重启服务

```bash
# 重启MySQL
# Windows
net stop MySQL80
net start MySQL80

# Linux
sudo systemctl restart mysql

# 重启Redis
# Windows
net stop Redis
net start Redis

# Linux
sudo systemctl restart redis
```

---

## 📝 Git命令

```bash
# 初始化仓库
git init

# 添加远程仓库
git remote add origin <url>

# 查看状态
git status

# 添加文件
git add .

# 提交
git commit -m "Phase 1: 完成基础架构"

# 推送
git push origin main

# 拉取
git pull origin main

# 创建分支
git checkout -b feature/user-module

# 合并分支
git checkout main
git merge feature/user-module

# 查看日志
git log --oneline

# 回退版本
git reset --hard HEAD~1
```

---

## 🎯 快捷脚本

### 一键启动脚本（start.sh）

```bash
#!/bin/bash

echo "启动MySQL..."
systemctl start mysql

echo "启动Redis..."
systemctl start redis

echo "启动后端..."
cd qa-system-backend
mvn spring-boot:run &

echo "启动前端..."
cd ../qa-system-frontend
npm run dev &

echo "所有服务已启动！"
```

### 一键构建脚本（build.sh）

```bash
#!/bin/bash

echo "构建后端..."
cd qa-system-backend
mvn clean package -DskipTests

echo "构建前端..."
cd ../qa-system-frontend
npm run build

echo "构建Docker镜像..."
docker-compose build

echo "构建完成！"
```

---

## 📚 常用链接

- Spring Boot文档: https://spring.io/projects/spring-boot
- Vue 3文档: https://cn.vuejs.org/
- Element Plus文档: https://element-plus.org/zh-CN/
- MyBatis-Plus文档: https://baomidou.com/
- Redis文档: https://redis.io/docs/
- Docker文档: https://docs.docker.com/

---

**保存此文档以便快速查阅！** 📖

