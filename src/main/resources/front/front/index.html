<!-- 首页 -->
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>首页</title>
	<link rel="stylesheet" href="./layui/css/layui.css">
	<link rel="stylesheet" href="./xznstatic/css/common.css"/>
	<link rel="stylesheet" href="./xznstatic/css/style.css"/>
</head>
<style >

	html, body {
		height: 100%;
		margin: 0;
		font-family: 'Arial', sans-serif;
	}
	#iframe {
		width: 100%;
		margin-top: 100px;
		padding-top: 50px;
	}

	/* 顶部导航栏 */
	#header {
		height: auto;
		background: #fff;
		border-bottom: 0;
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		z-index: 999;
	}

	#header .nav-top {
		display: flex;
		align-items: center;
		padding: 0 20px;
		font-size: 16px;
		color: #2a8a15;
		box-sizing: border-box;
		height: 100px;
		background-color: rgba(255, 255, 255, 1);
		box-shadow: 0 1px 0px rgba(0, 0, 0, .3);
		justify-content: flex-start;
		position: relative;
	}

	#header .nav-top-title {
		position: fixed;
		top: 10px;
		left: 50%;
		transform: translateX(-50%);
		font-size: 40px;
		font-weight: 700;
		color: transparent;
		padding: 15px 25px;
		border-radius: 15px;
		background: linear-gradient(135deg, #6a82fb, #fc5c7d);
		-webkit-background-clip: text;
		background-clip: text;
		opacity: 0;
		animation: fadeIn 2s forwards, scaleUp 1.5s 2s forwards, glow 1.5s infinite alternate;
		text-align: center;
	}

	/* 动画 */
	@keyframes fadeIn {
		0% {
			opacity: 0;
			transform: translateX(-50%) scale(0.5);
		}
		100% {
			opacity: 1;
			transform: translateX(-50%) scale(1);
		}
	}

	@keyframes scaleUp {
		0% {
			transform: translateX(-50%) scale(0.5);
		}
		100% {
			transform: translateX(-50%) scale(1);
		}
	}

	@keyframes glow {
		0% {
			box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
		}
		100% {
			box-shadow: 0 0 30px rgba(255, 255, 255, 1);
		}
	}

	/* 导航栏 */
	#header .navs {
		display: flex;
		padding: 0 20px;
		align-items: center;
		box-sizing: border-box;
		height: 60px;
		background-color: #333;
		justify-content: center;
		box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
		transition: background-color 0.5s ease;
	}

	#header .navs li {
		display: inline-block;
		padding: 0 15px;
		margin: 0 5px;
		color: #fff;
		font-size: 18px;
		border-radius: 6px;
		cursor: pointer;
		transition: background-color 0.3s ease, color 0.3s ease, transform 0.3s ease, font-size 0.3s ease;
	}

	#header .navs li a {
		color: inherit;
		text-decoration: none;
	}
	#header .navs li {
		letter-spacing: 0.5px;
		position: relative;
		font-size: 18px;
		color: rgba(255, 255, 255, 0.9); /* 白色字体 */
		font-family: 'Arial', sans-serif;
		background-color: rgb(75, 75, 237); /* 深黑色背景 */
		background-image: linear-gradient(45deg,
		rgba(228, 214, 214, 0.74),
		rgba(0, 255, 0, 0.1),
		rgba(0, 0, 255, 0.1),
		rgba(255, 255, 0, 0.1),
		rgba(255, 0, 255, 0.1)
		);
		background-blend-mode: multiply; /* 颜色融合效果 */
		transition: all 0.3s ease;
	}



	/* hover效果 */
	#header .navs li:hover {
		color:yellow;
		background-color: transparent;
		font-size: 22px;
		background-clip: text;
		-webkit-background-clip: text;
		animation: hoverTextEffect 1.2s ease-out forwards;
	}

	/* 当前项样式 */
	#header .navs li.current {
		font-size: 22px;
		color: #fff;
		animation: currentTextEffect 1.5s ease-out forwards;
	}

	/* 点击时效果：背景色切换并显示字体，字体不透明 */
	#header .navs li:active {
		background-color: #4CAF50; /* 绿色背景 */
		color: #fff;  /* 确保字体颜色不变 */
		font-size: 24px;
		animation: activeTextEffect 1s ease-out forwards;
		text-shadow: none; /* 移除光晕效果 */
	}

	/* 动态字体效果 - hover */
	@keyframes hoverTextEffect {
		0% {
			transform: scale(1);
			letter-spacing: 0.5px;
		}
		50% {
			transform: scale(1.1);
			letter-spacing: 2px;
		}
		100% {
			transform: scale(1.2);
			letter-spacing: 3px;
		}
	}

	/* 动态字体效果 - 当前项 */
	@keyframes currentTextEffect {
		0% {
			color: transparent;
			background-image: linear-gradient(135deg, #6a82fb, #808080); /* 蓝色与灰色渐变 */
			background-clip: text;
			-webkit-background-clip: text;
			transform: scale(1);
			letter-spacing: 0px;
		}
		50% {
			transform: scale(1.1);
			letter-spacing: 2px;
		}
		100% {
			color: transparent;
			background-image: linear-gradient(135deg, #6a82fb, #808080); /* 蓝色与灰色渐变 */
			background-clip: text;
			-webkit-background-clip: text;
			transform: scale(1.2);
			letter-spacing: 4px;
			text-shadow: 0 0 15px rgba(255, 255, 255, 0.6), 0 0 25px rgba(0, 255, 255, 0.8);
		}
	}

	/* 动态字体效果 - 点击时 */
	@keyframes activeTextEffect {
		0% {
			background-color: #4CAF50; /* 绿色 */
			color: #fff;
			transform: scale(1);
			background-clip: text;
			-webkit-background-clip: text;
			letter-spacing: 1px;
		}
		50% {
			background-color: #388E3C; /* 更深绿色 */
			color: #fff;
			transform: scale(1.1);
			background-clip: text;
			-webkit-background-clip: text;
			letter-spacing: 3px;
		}
		100% {
			background-color: #66BB6A; /* 轻绿色 */
			color: #fff;
			transform: scale(1.2);
			background-clip: text;
			-webkit-background-clip: text;
			letter-spacing: 4px;
			text-shadow: 0 0 10px rgba(0, 255, 0, 0.6), 0 0 20px rgba(0, 255, 255, 0.8);
		}
	}



	/* 响应式处理：移动端样式 */
	@media (max-width: 768px) {
		#header .navs {
			flex-direction: column;
			align-items: flex-start;
		}

		#header .navs li {
			padding: 10px 20px;
			width: 100%;
			text-align: left;
		}
	}

	/* 音乐播放器基础样式 */
	.music-player {
		position: fixed;
		left: 20px;
		bottom: 20px;
		z-index: 1000;
		display: flex;
		align-items: center;
		background: rgba(15, 15, 15, 0.95);
		padding: 12px;
		border-radius: 30px;
		min-width: 60px;
		max-width: 350px;
		transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
		backdrop-filter: blur(20px);
		box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
		border: 1px solid rgba(255, 255, 255, 0.1);
	}

	/* 收起状态样式 */
	.music-player.collapsed {
		width: auto;
		padding: 8px 12px;
		gap: 8px;
	}

	/* 主播放按钮样式 */
	.main-btn {
		width: 40px;
		height: 40px;
		border-radius: 50%;
		background: linear-gradient(145deg, #1ed760, #1db954);
		border: none;
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		font-size: 18px;
		color: white;
		transition: all 0.3s ease;
		position: relative;
		z-index: 2;
	}

	/* 音频可视化效果调整 */
	.audio-visualizer {
		display: flex;
		align-items: center;
		height: 40px;
		gap: 2px;
		margin-left: 8px;
		opacity: 0;
		transition: opacity 0.3s ease;
	}

	.collapsed.playing .audio-visualizer {
		opacity: 1;
	}

	/* 展开控制面板样式 */
	.expanded-controls {
		display: flex;
		align-items: center;
		gap: 15px;
		margin-left: 15px;
		opacity: 0;
		transition: opacity 0.3s ease;
	}

	.music-player:not(.collapsed) .expanded-controls {
		opacity: 1;
	}

	/* 控制按钮组样式 */
	.control-buttons {
		display: flex;
		gap: 8px;
	}

	/* 修改进度条容器样式 */
	.progress-container {
		flex: 1;
		min-width: 0;
	}

	/* 音乐控制按钮 */
	.music-btn, .next-btn {
		width: 34px;
		height: 34px;
		border: none;
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		font-size: 16px;
		transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		background: #252525;
		color: #fff;
		border-radius: 50%;
		position: relative;
		overflow: hidden;
	}

	.music-btn::after, .next-btn::after {
		content: '';
		position: absolute;
		top: 50%;
		left: 50%;
		width: 0;
		height: 0;
		background: rgba(255, 255, 255, 0.2);
		border-radius: 50%;
		transform: translate(-50%, -50%);
		transition: width 0.3s, height 0.3s;
	}

	.music-btn:hover::after, .next-btn:hover::after {
		width: 100%;
		height: 100%;
	}

	/* 进度条容器 */
	.progress-container {
		flex: 1;
		display: flex;
		flex-direction: column;
		gap: 8px;
		opacity: 1;
		transition: opacity 0.3s ease;
	}

	.collapsed .progress-container {
		opacity: 0;
	}

	/* 音乐标题动画 */
	.music-title {
		color: #fff;
		font-size: 13px;
		white-space: nowrap;
		overflow: hidden;
		position: relative;
	}

	.music-title::after {
		content: '';
		position: absolute;
		right: 0;
		top: 0;
		height: 100%;
		width: 40px;
		background: linear-gradient(to right, transparent, rgba(15, 15, 15, 0.95));
	}

	/* 进度条样式 */
	.progress-bar {
		width: 100%;
		height: 4px;
		background: rgba(255, 255, 255, 0.1);
		border-radius: 2px;
		cursor: pointer;
		position: relative;
		overflow: hidden;
	}

	.progress-bar-fill {
		height: 100%;
		background: #1ed760;
		border-radius: 2px;
		position: relative;
		transition: width 0.1s linear;
	}

	.progress-bar-fill::after {
		content: '';
		position: absolute;
		right: -4px;
		top: 50%;
		width: 8px;
		height: 8px;
		background: #fff;
		border-radius: 50%;
		transform: translateY(-50%) scale(0);
		transition: transform 0.2s;
	}

	.progress-bar:hover .progress-bar-fill::after {
		transform: translateY(-50%) scale(1);
	}

	/* 音量控制 */
	.volume-control {
		display: flex;
		align-items: center;
		gap: 8px;
		opacity: 1;
		transition: opacity 0.3s ease;
	}

	.collapsed .volume-control {
		opacity: 0;
	}

	/* 时间显示 */
	.time-display {
		color: rgba(255, 255, 255, 0.7);
		font-size: 11px;
		font-family: 'Monaco', monospace;
	}

	/* 粒子效果 */
	@keyframes particle {
		0% {
			transform: scale(0) rotate(0deg);
			opacity: 1;
		}
		100% {
			transform: scale(1) rotate(360deg);
			opacity: 0;
		}
	}

	.particle {
		position: absolute;
		pointer-events: none;
		background: #1ed760;
		border-radius: 50%;
	}

	/* 响应式布局 */
	@media (max-width: 390px) { /* iPhone 15 屏幕宽度 */
		.music-player {
			left: 10px;
			bottom: 10px;
			padding: 10px;
			max-width: calc(100% - 20px);
		}

		.volume-control {
			display: none; /* 在手机上隐藏音量控制 */
		}

		.music-btn, .next-btn {
			width: 32px;
			height: 32px;
		}

		.time-display {
			min-width: 70px;
		}
	}

	/* 音频可视化效果 */
	.audio-visualizer {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 2px;
		height: 100%;
		padding: 0 8px;
	}

	.visualizer-bar {
		width: 2px;
		height: 15px;
		background: #1ed760;
		border-radius: 1px;
		transform-origin: bottom;
	}

	/* 播放状态下的动画 */
	.playing .visualizer-bar:nth-child(1) { animation: soundBars 1s ease-in-out infinite; }
	.playing .visualizer-bar:nth-child(2) { animation: soundBars 1s ease-in-out 0.2s infinite; }
	.playing .visualizer-bar:nth-child(3) { animation: soundBars 1s ease-in-out 0.4s infinite; }
	.playing .visualizer-bar:nth-child(4) { animation: soundBars 1s ease-in-out 0.6s infinite; }

	@keyframes soundBars {
		0%, 100% { transform: scaleY(0.3); }
		50% { transform: scaleY(1); }
	}

	/* 音量控制优化 */
	.volume-control {
		position: relative;
		display: flex;
		align-items: center;
		gap: 8px;
	}

	.volume-slider {
		position: relative;
		width: 60px;
		height: 4px;
		background: rgba(255, 255, 255, 0.1);
		border-radius: 2px;
		cursor: pointer;
	}

	.volume-slider-fill {
		position: absolute;
		left: 0;
		top: 0;
		height: 100%;
		background: #1ed760;
		border-radius: 2px;
	}

	.volume-slider-handle {
		position: absolute;
		top: 50%;
		width: 12px;
		height: 12px;
		background: #fff;
		border-radius: 50%;
		transform: translate(-50%, -50%);
		cursor: pointer;
		transition: transform 0.2s;
	}

	.volume-slider-handle:hover {
		transform: translate(-50%, -50%) scale(1.2);
	}

	/* 音乐控制按钮组样式 */
	.music-controls {
		display: flex;
		align-items: center;
		gap: 8px;
	}

	/* 上一首/下一首按钮样式 */
	.prev-btn, .next-btn {
		width: 28px;
		height: 28px;
		font-size: 14px;
		opacity: 0.8;
		transition: all 0.3s ease;
	}

	.prev-btn:hover, .next-btn:hover {
		opacity: 1;
		transform: scale(1.1);
	}

	/* 按钮点击效果 */
	.prev-btn:active, .next-btn:active {
		transform: scale(0.95);
	}

	/* 移动端适配样式 */
	@media (max-width: 768px) {
		/* 导航栏移动端优化 */
		#header {
			position: fixed;
			width: 100%;
			z-index: 1000;
		}

		#header .nav-top {
			height: 60px;
			padding: 0 15px;
		}

		#header .nav-top-title {
			font-size: 24px;
			padding: 10px 15px;
		}

		.navs {
			padding: 5px 0;
			overflow-x: auto;
			-webkit-overflow-scrolling: touch;
			white-space: nowrap;
			height: auto;
		}

		.navs::-webkit-scrollbar {
			display: none;
		}

		.navs .list {
			display: flex;
			padding: 0 10px;
		}

		.navs ul {
			display: flex;
			flex-wrap: nowrap;
			margin: 0;
			padding: 0;
		}

		.navs li {
			flex: 0 0 auto;
			padding: 8px 15px;
			margin: 0 5px;
			font-size: 14px;
			border-radius: 15px;
		}

		/* iframe 调整 */
		#iframe {
			margin-top: 110px;
			padding-top: 0;
		}

		/* 底部 tabbar 优化 */
		#tabbar {
			padding: 15px 0 !important;
		}

		/* 音乐播放器移动端优化 */
		.music-player {
			left: 50%;
			transform: translateX(-50%);
			bottom: 80px;
			max-width: 92%;
			border-radius: 20px;
			padding: 8px;
		}

		.music-player.collapsed {
			left: 15px;
			transform: none;
			width: 45px;
			height: 45px;
			padding: 0;
			border-radius: 50%;
		}

		/* 主播放按钮调整 */
		.main-btn {
			width: 45px;
			height: 45px;
			font-size: 20px;
		}

		/* 展开面板移动端布局 */
		.expanded-controls {
			flex-direction: column;
			gap: 8px;
			margin-left: 10px;
			padding: 5px 0;
		}

		/* 控制按钮组移动端样式 */
		.control-buttons {
			order: 1;
			justify-content: center;
			width: 100%;
		}

		.prev-btn, .next-btn {
			width: 35px;
			height: 35px;
		}

		/* 进度条容器移动端样式 */
		.progress-container {
			order: 2;
			width: 100%;
			padding: 0 5px;
		}

		.music-title {
			font-size: 13px;
			margin-bottom: 5px;
			text-align: center;
		}

		.time-display {
			font-size: 10px;
			margin-top: 3px;
		}

		/* 音量控制移动端隐藏 */
		.volume-control {
			display: none;
		}

		/* 音频可视化效果调整 */
		.audio-visualizer {
			height: 25px;
			margin-left: 5px;
		}

		.visualizer-bar {
			width: 2px;
			margin: 0 1px;
		}
	}

	/* 针对超小屏幕的优化 */
	@media (max-width: 320px) {
		#header .nav-top-title {
			font-size: 20px;
		}

		.navs li {
			padding: 6px 12px;
			font-size: 13px;
		}

		.music-player.collapsed {
			width: 40px;
			height: 40px;
		}

		.main-btn {
			width: 40px;
			height: 40px;
			font-size: 18px;
		}
	}

	/* 增加触摸反馈效果 */
	@media (hover: none) {
		.music-btn:active, .prev-btn:active, .next-btn:active {
			transform: scale(0.95);
			background: rgba(255, 255, 255, 0.1);
		}

		.volume-slider-handle:active {
			transform: translate(-50%, -50%) scale(1.3);
		}
	}
</style>

<!--	</style>-->
<body>
<!-- start 顶部导航栏 -->
<div id="header">
	<div v-if='true' class="nav-top">
		<img v-if='false' class="nav-top-img" src='https://www.baidu.com/img/flexible/logo/pc/result@2.png'>
		<div v-if="true" class="nav-top-title">{{projectName}}</div>
		<div class="nav-top-tel"></div>
	</div>
	<div class="navs">
		<!-- <div class="logo" style="font-size: 20px;top: 32px;color: #fff;font-weight: bold;margin-left: -200px;width: 240px;" v-text="projectName"></div> -->
		<div class="title" v-if="false" v-text="projectName"></div>
		<div class="list">
			<ul>
				<li class='current'><a href="javascript:navPage('./pages/home/home.html')" class="menumain"><i v-if="false" class="layui-icon layui-icon-home"></i>首页</a></li>
				<li v-for="(item,index) in indexNav" v-bind:key="index"><a :href="'javascript:navPage(\''+item.url+'\')'" class="menumain" style="cursor: pointer;"><i v-if="false" class="layui-icon" :class="iconArr[index]"></i>{{item.name}}</a></li>
				<li><a href="javascript:centerPage();" class="menumain"><i v-if="false" class="layui-icon layui-icon-username"></i>个人中心</a></li>
				<li><a :href="adminurl" target="_blank" class="menumain" style="cursor: pointer;"><i v-if="false" class="layui-icon layui-icon-link"></i>后台管理</a></li>
				<li v-if="cartFlag"><a href="javascript:navPage('./pages/shop-cart/list.html')" class="menumain"><i v-if="false" class="layui-icon">&#xe657;</i>你好</a></li>
				<li v-if="chatFlag"><a href="javascript:chatTap()" class="menumain"><i v-if="false" class="layui-icon">&#xe677;</i>你好</a></li>
			</ul>
		</div>
	</div>
</div>
<!-- end 顶部导航栏 -->

<iframe src="./pages/home/home.html" id="iframe" frameborder="0" scrolling="no" width="100%" onload="changeFrameHeight"></iframe>

<div id="tabbar" v-if="true" class="tabbar" :style='{"padding":"50px 0","boxShadow":"0 0 0px rgba(255,0,0,.8)","margin":"10px 0 0 0","borderColor":"rgba(0,0,0,.3)","backgroundColor":"rgba(27, 27, 27, 1)","borderRadius":"0","borderWidth":"0","borderStyle":"solid"}' style="position: relative;z-index: 999;">
	<img v-if='false' :style='{"boxShadow":"0 0 6px rgba(255,0,0,.8)","margin":"0 auto","borderColor":"rgba(0,0,0,.3)","borderRadius":"100%","borderWidth":"1px","width":"44px","borderStyle":"solid","height":"44px"}' style='display: block;' src='http://codegen.caihongy.cn/20201024/ed5e326ca66f403aa3197b5fbb4ec733.jpg' />
	<div :style='{"padding":"0 10px","boxShadow":"0 0 6px rgba(255,0,0,.8)","margin":"10px auto","borderColor":"rgba(0,0,0,1)","backgroundColor":"#000","color":"#fff","textAlign":"center","borderRadius":"0","borderWidth":"0","width":"100%","lineHeight":"32px","fontSize":"14px","borderStyle":"solid"}' class="company"></div>
	<div :style='{"padding":"0 10px","boxShadow":"0 0 6px rgba(255,0,0,0)","margin":"10px auto","borderColor":"rgba(0,0,0,1)","backgroundColor":"#000","color":"#fff","textAlign":"center","borderRadius":"0","borderWidth":"0","width":"100%","lineHeight":"32px","fontSize":"14px","borderStyle":"solid"}' class="record"></div>
	<div :style='{"padding":"0 0px","boxShadow":"0 0 px rgba(255,0,0,0)","margin":"0px auto 0px auto","borderColor":"rgba(255,255,255,1)","backgroundColor":"rgba(27, 27, 27, 1)","color":"#fff","textAlign":"center","borderRadius":"0","borderWidth":"0px 0px ","width":"40%","lineHeight":"32px","fontSize":"14px","borderStyle":"solid"}' class="desc"></div>
</div>

<div id="musicPlayer" class="music-player" :class="{ collapsed: isCollapsed, playing: isPlaying }"
	 @mouseenter="expandPlayer" @mouseleave="collapsePlayer"
	 @touchstart.prevent="handleTouchStart"
	 @touchend.prevent="handleTouchEnd">
	<div class="music-controls">
		<button class="music-btn main-btn" @click="toggleMusic">
			<i class="layui-icon" :class="isPlaying ? 'layui-icon-pause' : 'layui-icon-play'"></i>
		</button>
		<!-- 音频可视化 - 移到主按钮旁边 -->
		<div v-if="isPlaying" class="audio-visualizer">
			<div class="visualizer-bar"></div>
			<div class="visualizer-bar"></div>
			<div class="visualizer-bar"></div>
			<div class="visualizer-bar"></div>
		</div>
	</div>
	<!-- 展开时显示的控制面板 -->
	<div class="expanded-controls" v-show="!isCollapsed">
		<div class="control-buttons">
			<button class="music-btn prev-btn" @click="playPrev">
				<i class="layui-icon layui-icon-prev"></i>
			</button>
			<button class="music-btn next-btn" @click="playNext">
				<i class="layui-icon layui-icon-next"></i>
			</button>
		</div>
		<div class="progress-container">
			<div class="music-title" v-if="currentSong">{{currentSong.name}}</div>
			<div class="progress-bar"
				 @click="seek"
				 @touchstart.stop="handleProgressTouchStart"
				 @touchmove.stop="handleProgressTouchMove"
				 @touchend.stop="handleProgressTouchEnd"
				 ref="progressBar">
				<div class="progress-bar-fill" :style="{width: progress + '%'}"></div>
			</div>
			<div class="time-display">{{currentTime}} / {{duration}}</div>
		</div>
		<div class="volume-control">
			<i class="layui-icon"
			   :class="volume > 0 ? 'layui-icon-voice' : 'layui-icon-mute'"
			   @click="toggleMute"></i>
			<div class="volume-slider"
				 ref="volumeBar"
				 @mousedown="startVolumeChange"
				 @mousemove="handleVolumeChange"
				 @mouseup="endVolumeChange"
				 @mouseleave="endVolumeChange"
				 @touchstart.stop="handleVolumeTouchStart"
				 @touchmove.stop="handleVolumeTouchMove"
				 @touchend.stop="handleVolumeTouchEnd">
				<div class="volume-slider-fill" :style="{width: volume * 100 + '%'}"></div>
				<div class="volume-slider-handle" :style="{left: volume * 100 + '%'}"></div>
			</div>
		</div>
	</div>
</div>

<script src="./xznstatic/js/jquery-1.11.3.min.js"></script>
<script src="./layui/layui.js"></script>
<script src="./js/vue.js"></script>
<script src="./js/config.js"></script>

<script>
	var vue1 = new Vue({el: '#tabbar'})

	var vue = new Vue({
		el: '#header',
		data: {
			iconArr: ['layui-icon-gift','layui-icon-email','layui-icon-logout','layui-icon-transfer','layui-icon-slider','layui-icon-print','layui-icon-cols','layui-icon-snowflake','layui-icon-note','layui-icon-flag','layui-icon-theme','layui-icon-website','layui-icon-console','layui-icon-face-surprised','layui-icon-template-1','layui-icon-app','layui-icon-read','layui-icon-component','layui-icon-file-b','layui-icon-unlink','layui-icon-tabs','layui-icon-form','layui-icon-chat'],
			indexNav: indexNav,
			cartFlag: cartFlag,
			adminurl: adminurl,
			chatFlag: chatFlag,
			projectName: projectName,
			isProgressTouching: false,
			isVolumeTouching: false,
			touchTimer: null,
		},
		mounted: function() {
			this.bindClickOnLi();
		},
		created() {
			this.iconArr.sort(()=>{
				return (0.5-Math.random())
			})
		},
		methods: {
			jump(url) {
				jump(url)
			},
			bindClickOnLi() {
				let list = document.getElementsByTagName("li");
				for(var i = 0;i<list.length;i++){
					list[i].onclick = function(){
						$(this).addClass("current").siblings().removeClass("current");
					}
				}
			},
			handleTouchStart(event) {
				clearTimeout(this.touchTimer);
				this.touchStartTime = Date.now();
				this.touchStartX = event.touches[0].clientX;
				this.touchStartY = event.touches[0].clientY;
				this.isSwiping = false;

				// 长按展开播放器
				this.touchTimer = setTimeout(() => {
					this.isCollapsed = !this.isCollapsed;
				}, 500);
			},
			handleTouchEnd(event) {
				clearTimeout(this.touchTimer);
				const touchEndX = event.changedTouches[0].clientX;
				const touchEndY = event.changedTouches[0].clientY;
				const touchDuration = Date.now() - this.touchStartTime;
				const touchDistanceX = Math.abs(touchEndX - this.touchStartX);
				const touchDistanceY = Math.abs(touchEndY - this.touchStartY);

				// 如果正在操作进度条或音量，不执行其他操作
				if (this.isProgressTouching || this.isVolumeTouching) {
					return;
				}

				// 短按播放/暂停
				if (touchDuration < 200 && touchDistanceX < 10 && touchDistanceY < 10) {
					this.toggleMusic();
					return;
				}

				// 水平滑动切换歌曲
				if (touchDistanceX > 50 && touchDistanceX > touchDistanceY * 1.5) {
					if (touchEndX > this.touchStartX) {
						this.playPrev();
					} else {
						this.playNext();
					}
				}
			},
			handleProgressTouchStart(event) {
				this.isProgressTouching = true;
				this.handleProgressTouch(event);
			},
			handleProgressTouchMove(event) {
				if (!this.isProgressTouching) return;
				this.handleProgressTouch(event);
			},
			handleProgressTouchEnd() {
				this.isProgressTouching = false;
			},
			handleProgressTouch(event) {
				event.preventDefault();
				event.stopPropagation();
				const rect = this.$refs.progressBar.getBoundingClientRect();
				const x = event.touches[0].clientX - rect.left;
				const percent = Math.max(0, Math.min(1, x / rect.width));
				this.audioPlayer.currentTime = percent * this.audioPlayer.duration;
			},
			handleVolumeTouchStart(event) {
				this.isVolumeTouching = true;
				this.handleVolumeTouch(event);
			},
			handleVolumeTouchMove(event) {
				if (!this.isVolumeTouching) return;
				this.handleVolumeTouch(event);
			},
			handleVolumeTouchEnd() {
				this.isVolumeTouching = false;
			},
			handleVolumeTouch(event) {
				event.preventDefault();
				event.stopPropagation();
				const rect = this.$refs.volumeBar.getBoundingClientRect();
				const x = event.touches[0].clientX - rect.left;
				let percent = Math.max(0, Math.min(1, x / rect.width));
				this.volume = percent;
				this.audioPlayer.volume = this.volume;
			}
		}
	});

	layui.use('layer', function() {
		window.layer = layui.layer;
	});

	function chatTap(){
		var userTable = localStorage.getItem('userTable');
		if (userTable) {
			layer.open({
				type: 2,
				title: '你好',
				area: ['600px', '600px'],
				content: './pages/chat/chat.html'
			});
		} else {
			window.location.href = './pages/login/login.html'
		}
	}

	// 导航栏跳转
	function navPage(url) {
		localStorage.setItem('iframeUrl', url);
		document.getElementById('iframe').src = url;
	}

	// 跳转到个人中心
	function centerPage() {
		var userTable = localStorage.getItem('userTable');
		if (userTable) {
			localStorage.setItem('iframeUrl', './pages/' + userTable + '/center.html');
			document.getElementById('iframe').src = './pages/' + userTable + '/center.html';
		} else {
			window.location.href = './pages/login/login.html'
		}
	}

	var iframeUrl = localStorage.getItem('iframeUrl');
	document.getElementById('iframe').src = iframeUrl || './pages/home/home.html';

	setInterval(function(){
		changeFrameHeight();
	},200)

	function changeFrameHeight() {
		var iframe = document.getElementById('iframe');
		if (iframe) {
			var iframeWin = iframe.contentWindow || iframe.contentDocument.parentWindow;
			if (iframeWin.document.body) {
				iframe.height = iframeWin.document.body.scrollHeight;
			}
		}
	}

	// reasize 事件 窗口大小变化后执行的方法
	window.onresize = function() {
		changeFrameHeight();
	}

	// 修改音乐播放器实例的声明
	window.musicPlayer = new Vue({
		el: '#musicPlayer',
		data: {
			isPlaying: false,
			currentSong: null,
			audioPlayer: null,
			playlist: [
				{
					name: '一点',
					url: '../upload/一点.mp3'
				},
				{
					name: '逃爱',
					url: '../upload/逃爱.mp3'
				},
				{
					name: '春不晚',
					url: '../upload/春不晚.mp3'
				},
				{
					name: '懒洋洋',
					url: '../upload/懒洋洋.mp3'
				}
			],
			currentIndex: 0,
			progress: 0,
			volume: 0.7,
			currentTime: '00:00',
			duration: '00:00',
			isCollapsed: true, // 添加收起状态控制
			previousVolume: 0.7, // 存储静音前的音量
			isDraggingVolume: false,
			touchStartTime: 0,
			touchStartX: 0,
			touchStartY: 0,
			isSwiping: false
		},
		mounted() {
			this.initAudioPlayer();
			// 添加时间更新事件监听
			this.audioPlayer.addEventListener('timeupdate', this.updateProgress);
			this.audioPlayer.addEventListener('loadedmetadata', this.setDuration);
			// 设置初始音量
			this.audioPlayer.volume = this.volume;
		},
		methods: {
			initAudioPlayer() {
				this.audioPlayer = new Audio();
				this.currentSong = this.playlist[0];
				this.audioPlayer.src = this.playlist[0].url;

				this.audioPlayer.addEventListener('loadeddata', () => {
					console.log('Audio loaded successfully');
				});

				this.audioPlayer.addEventListener('ended', () => {
					this.playNext();
				});
			},
			toggleMusic() {
				try {
					if (this.isPlaying) {
						this.audioPlayer.pause();
					} else {
						if (this.audioPlayer.readyState >= 2) {
							this.audioPlayer.play().catch(e => {
								console.error('Play failed:', e);
							});
						}
					}
					this.isPlaying = !this.isPlaying;
					this.isCollapsed = true; // 播放时始终收起
				} catch (e) {
					console.error('Toggle music error:', e);
				}
			},
			playNext() {
				try {
					this.currentIndex = (this.currentIndex + 1) % this.playlist.length;
					this.currentSong = this.playlist[this.currentIndex];
					this.audioPlayer.src = this.currentSong.url;

					if (this.isPlaying) {
						this.audioPlayer.play().catch(e => {
							console.error('Play next failed:', e);
						});
					}
				} catch (e) {
					console.error('Next song error:', e);
				}
			},
			// 格式化时间
			formatTime(seconds) {
				const mins = Math.floor(seconds / 60);
				const secs = Math.floor(seconds % 60);
				return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
			},

			// 更新进度条
			updateProgress() {
				if (this.audioPlayer.duration) {
					this.progress = (this.audioPlayer.currentTime / this.audioPlayer.duration) * 100;
					this.currentTime = this.formatTime(this.audioPlayer.currentTime);
				}
			},

			// 设置音频总时长
			setDuration() {
				this.duration = this.formatTime(this.audioPlayer.duration);
			},

			// 跳转播放位置
			seek(event) {
				const rect = this.$refs.progressBar.getBoundingClientRect();
				const x = event.touches ? event.touches[0].clientX : event.clientX;
				const percent = (x - rect.left) / rect.width;
				this.audioPlayer.currentTime = percent * this.audioPlayer.duration;
			},

			// 设置音量
			setVolume(event) {
				const rect = this.$refs.volumeBar.getBoundingClientRect();
				const percent = (event.clientX - rect.left) / rect.width;
				this.volume = Math.max(0, Math.min(1, percent));
				this.audioPlayer.volume = this.volume;
			},

			// 展开播放器
			expandPlayer() {
				this.isCollapsed = false;
			},

			// 收起播放器
			collapsePlayer() {
				this.isCollapsed = true;
			},

			// 音量控制相关方法
			toggleMute() {
				if (this.volume > 0) {
					this.previousVolume = this.volume;
					this.volume = 0;
				} else {
					this.volume = this.previousVolume;
				}
				this.audioPlayer.volume = this.volume;
			},

			startVolumeChange(event) {
				this.isDraggingVolume = true;
				this.handleVolumeChange(event);
			},

			handleVolumeChange(event) {
				if (!this.isDraggingVolume) return;
				const rect = this.$refs.volumeBar.getBoundingClientRect();
				const x = event.touches ? event.touches[0].clientX : event.clientX;
				let percent = (x - rect.left) / rect.width;
				percent = Math.max(0, Math.min(1, percent));
				this.volume = percent;
				this.audioPlayer.volume = this.volume;
			},

			endVolumeChange() {
				this.isDraggingVolume = false;
			},

			// 播放上一首
			playPrev() {
				try {
					this.currentIndex = (this.currentIndex - 1 + this.playlist.length) % this.playlist.length;
					this.currentSong = this.playlist[this.currentIndex];
					this.audioPlayer.src = this.currentSong.url;

					if (this.isPlaying) {
						this.audioPlayer.play().catch(e => {
							console.error('Play previous failed:', e);
						});
					}
				} catch (e) {
					console.error('Previous song error:', e);
				}
			},

			// 修改触摸处理方法
			handleTouchStart(event) {
				// 记录初始触摸位置和时间
				this.touchStartTime = Date.now();
				this.touchStartX = event.touches[0].clientX;
				this.touchStartY = event.touches[0].clientY; // 添加Y轴位置记录
				this.isSwiping = false;

				// 长按展开播放器
				this.touchTimer = setTimeout(() => {
					this.isCollapsed = !this.isCollapsed;
				}, 500);
			},

			// 修改触摸处理方法
			handleTouchEnd(event) {
				const touchEndX = event.changedTouches[0].clientX;
				const touchEndY = event.changedTouches[0].clientY;
				const touchDuration = Date.now() - this.touchStartTime;
				const touchDistanceX = Math.abs(touchEndX - this.touchStartX);
				const touchDistanceY = Math.abs(touchEndY - this.touchStartY);

				// 如果正在操作进度条或音量，不执行其他操作
				if (this.isProgressTouching || this.isVolumeTouching) {
					return;
				}

				// 短按播放/暂停
				if (touchDuration < 200 && touchDistanceX < 10 && touchDistanceY < 10) {
					this.toggleMusic();
					return;
				}

				// 水平滑动切换歌曲
				if (touchDistanceX > 50 && touchDistanceX > touchDistanceY * 1.5) {
					if (touchEndX > this.touchStartX) {
						this.playPrev();
					} else {
						this.playNext();
					}
				}
			},

			// 添加触摸进度条处理方法
			handleProgressTouch(event) {
				event.preventDefault();
				const rect = this.$refs.progressBar.getBoundingClientRect();
				const x = event.touches[0].clientX - rect.left;
				const percent = Math.max(0, Math.min(1, x / rect.width));
				this.audioPlayer.currentTime = percent * this.audioPlayer.duration;
			},

			// 添加触摸音量控制方法
			handleVolumeTouch(event) {
				event.preventDefault();
				const rect = this.$refs.volumeBar.getBoundingClientRect();
				const x = event.touches[0].clientX - rect.left;
				let percent = Math.max(0, Math.min(1, x / rect.width));
				this.volume = percent;
				this.audioPlayer.volume = this.volume;
			}
		}
	});

	// 添加一个初始化检查
	window.onload = function() {
		if (window.musicPlayer && window.musicPlayer.audioPlayer) {
			console.log('Music player initialized');
			// 测试音频加载
			window.musicPlayer.audioPlayer.load();
		} else {
			console.error('Music player not initialized properly');
		}
	};

	// 添加调试函数
	function testMusicPlayer() {
		if (window.musicPlayer && window.musicPlayer.audioPlayer) {
			window.musicPlayer.audioPlayer.play().then(() => {
				console.log('Playing successfully');
			}).catch(e => {
				console.error('Play failed:', e);
			});
		} else {
			console.error('Music player not available');
		}
	}

	// 粒子效果
	function createParticles(x, y) {
		const container = document.body;
		for (let i = 0; i < 8; i++) {
			const particle = document.createElement('div');
			particle.className = 'particle';
			const size = Math.random() * 4 + 2;
			particle.style.width = `${size}px`;
			particle.style.height = `${size}px`;
			particle.style.left = `${x}px`;
			particle.style.top = `${y}px`;

			const angle = Math.random() * Math.PI * 2;
			const velocity = Math.random() * 60 + 20;
			const dx = Math.cos(angle) * velocity;
			const dy = Math.sin(angle) * velocity;

			particle.style.animation = 'particle 0.8s ease-out forwards';
			particle.style.transform = `translate(${dx}px, ${dy}px)`;

			container.appendChild(particle);
			setTimeout(() => particle.remove(), 800);
		}
	}
</script>
</body>
</html>
